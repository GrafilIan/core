{% extends 'adminbase.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% load static %}

{% block head %}
    <link rel="stylesheet" href="{% static 'assets/modules/bootstrap-social/bootstrap-social.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/create_announcement.css' %}">
    <link rel="stylesheet" href="{% static 'assets/modules/datatables/datatables.min.css' %}">
    <link rel="stylesheet"
          href="{% static 'assets/modules/datatables/DataTables-1.10.16/css/dataTables.bootstrap4.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/modules/datatables/Select-1.2.4/css/select.bootstrap4.min.css' %}">

{% endblock %}


{% block content %}
    <div class="main-content" style="min-height: 569px;">

        <section class="section" style="margin-top: 12px;">
            <div class="section-header">

                <h1>Announcement</h1>
                <div class="section-header-breadcrumb">
                    <div class="breadcrumb-item active">Dashboard</div>
                    <div class="breadcrumb-item">Announcement</div>

                </div>
            </div>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-3 col-md-6 mb-3"> <!-- Added mb-3 for spacing on small screens -->
                        <div class="card1" style="background-color: #0f0f0f; color: #0da8ee;">
                            <div class="card1-content">
                                <h5>{{ course_count }} SorSU-BC Interns</h5>
                                <p>Total Interns</p>
                                <p style="line-height: 1; font-size: 13px;">Sorsogon State University-OJT</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6 mb-3"> <!-- Added mb-3 for spacing on small screens -->
                        <div class="card1">
                            <div class="card1-content">
                                <h5 style="margin-bottom: 35px;">{{ BSIT_count }} BSIT Interns</h5>
                                <p style="line-height: 1; font-size: 13px;">BS in Information Technology</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3"> <!-- Added mb-3 for spacing on small screens -->
                        <div class="card1">
                            <div class="card1-content">
                                <h5 style="margin-bottom: 35px;">{{ BSIS_count }} BSIS Interns</h5>
                                <p style="line-height: 1; font-size: 13px;">BS in Information System</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="card1">
                            <div class="card1-content">
                                <h5 style="margin-bottom: 35px;"> {{ BSCS_count }} BSCS Interns </h5>
                                <p style="line-height: 1; font-size: 13px;">BS in Computer Science</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container-fluid" style="margin-top: 10px;">
                <div class="row">


                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="card1">
                            <div class="card1-content">
                                <h5 style="margin-bottom: 35px;">{{ BSA_count }} BSA Interns</h5>
                                <p style="line-height: 1; font-size: 13px;">BS in Accountancy</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="card1">
                            <div class="card1-content">
                                <h5 style="margin-bottom: 21px;">{{ BSAIS_count }} BSAIS Interns</h5>
                                <p style="line-height: 1; font-size: 13px;">BS in Accounting Information System</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="card1">
                            <div class="card1-content">
                                <h5 style="margin-bottom: 35px;"> {{ BPA_count }} BPA Interns </h5>
                                <p style="line-height: 1; font-size: 13px;">Bachelor of Public Administration</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="card1">
                            <div class="card1-content">
                                <h5 style="margin-bottom: 35px;"> {{ BSCS_count }} BSE Interns </h5>
                                <p style="line-height: 1; font-size: 13px;">BS in Entrepreneurship</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="card col-md-5 float-right mb-3" style="margin-top: 20px;">
                <div class="card-header">
                    <h4>Intern Progress</h4>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped" id="table-2">
                            <thead>
                            <tr>
                                <th class="sorting" tabindex="0" aria-controls="table-2"
                                    rowspan="1" colspan="1"
                                    aria-label="Task Name: activate to sort column ascending"
                                    style="width: 135.344px;">Name
                                </th>
                                <th class="sorting_disabled" rowspan="1" colspan="1"
                                    aria-label="Members" style="width: 100px;">Progress
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="table-2"
                                    rowspan="1" colspan="1"
                                    aria-label="Status: activate to sort column ascending"
                                    style="width: 97.4688px;">Status
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for intern in interns %}
                                <tr role="row" class="odd">
                                    <td>{{ intern.user.first_name }}
                                        {% if intern.middle_name != 'na' %}
                                            {{ intern.middle_name }}
                                        {% endif %}

                                        {{ intern.user.last_name }}

                                        {% if intern.suffix != 'na' %}
                                            {{ intern.suffix }}
                                        {% endif %}</td>
                                    <td class="align-middle">
                                        <div class="progress" data-height="4" style="height: 4px;">
                                            <div class="progress-bar bg-warning"
                                                 style="width: {{ intern.remaining_percentage }}%;"></div>
                                        </div>
                                    </td>
                                    <td>
                                        <div>
                                            {{ intern.status_badge }}
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-7" style="margin-top: 20px;">
                <div class="card">
                    <div class="card-header col-lg-11">
                        <div class="row">
                            <div class="col-lg-8">
                                <h4 id="currentDate" style="font-size: 13px; white-space: nowrap;"></h4>
                            </div>
                            <div class="col-lg-4 text-lg-right">
                                <button class="btn btn-primary btn-lg btn-lg-block"
                                        onclick="window.location.href='{% url 'create_announcement' %}'">Create
                                    Announcement
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="carouselExampleIndicators2" class="carousel slide" data-ride="carousel">
                        <ol class="carousel-indicators">
                            {% for announcement in announcements %}
                                {% if announcement.announcement_list %}
                                    <li data-target="#carouselExampleIndicators2" data-slide-to="{{ forloop.counter0 }}"
                                            {% if forloop.first %} class="active"{% endif %}></li>
                                {% endif %}
                            {% endfor %}
                        </ol>
                        <div class="carousel-inner">
                            {% for announcement in announcements %}
                                {% if announcement.announcement_list %}
                                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                        <div class="announcement-image-container">
                                            {% if announcement.image_announcement %}
                                                <img src="{{ announcement.image_announcement.url|safe }}"
                                                     alt="Announcement Image" class="announcement-image">
                                                <div class="image-overlay"></div>
                                            {% else %}
                                                <!-- Default Image with Gradient Overlay -->
                                                <img src="{% static 'assets/img/news/img02.jpg' %}" alt="Default Image"
                                                     class="announcement-image">
                                                <div class="image-overlay"></div>
                                            {% endif %}
                                        </div>
                                        <div class="carousel-caption d-none d-md-block">
                                            <h5>{{ announcement.title }}</h5>
                                            <p>{{ announcement.announcement_list|safe }}</p>
                                            <p class="announcement-date">{{ announcement.pub_date|date:"F d, Y" }}</p>
                                            {% if announcement.document_announcement %}
                                                <a href="{{ announcement.document_announcement.url|safe }}"
                                                   target="_blank" class="announcement-link">View Document</a>
                                            {% endif %}
                                            <form method="post"
                                                  action="{% url 'delete_item' 'announcement' announcement.id %}"
                                                  id="delete-announcement-form-{{ announcement.id }}">
                                                {% csrf_token %}
                                                <input type="hidden" name="delete_announcement" value="1">
                                                <input type="hidden" name="announcement_id"
                                                       value="{{ announcement.id }}">
                                                <button type="button" class="btn delete-button" style="margin-top: 7px;"
                                                        data-announcement-id="{{ announcement.id }}">Delete
                                                </button>
                                            </form>
                                        </div>

                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleIndicators2" role="button"
                           data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleIndicators2" role="button"
                           data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>

                </div>
            </div>
        </section>
    </div>

{% endblock %}

{% block scripts %}


    <script src="{% static 'assets/modules/summernote/summernote-bs4.js' %}"></script>
    <script src="{% static 'assets/modules/jquery-selectric/jquery.selectric.min.js' %}"></script>
    <script src="{% static 'assets/modules/upload-preview/assets/js/jquery.uploadPreview.min.js' %}"></script>
    <script src="{% static 'assets/modules/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js' %}"></script>

    <!-- Page Specific JS File -->
    <script src="{% static 'assets/js/page/features-post-create.js' %}"></script>
    <script src="{% static 'assets/modules/datatables/datatables.min.js' %}"></script>
    <script src="{% static 'assets/modules/datatables/DataTables-1.10.16/js/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'assets/modules/datatables/Select-1.2.4/js/dataTables.select.min.js' %}"></script>
    <script src="{% static 'assets/modules/jquery-ui/jquery-ui.min.js' %}"></script>

    <!-- Page Specific JS File -->
    <script src="{% static 'assets/js/page/modules-datatables.js' %}"></script>


    <script src="{% static 'assets/modules/chocolat/dist/js/jquery.chocolat.min.js' %}"></script>
    <script src="{% static 'assets/modules/jquery-ui/jquery-ui.min.js' %}"></script>


    <!-- JS Libraies -->
    <script src="{% static 'assets/modules/sweetalert/sweetalert.min.js' %}"></script>
    <!-- Page Specific JS File -->
    <script src="{% static 'assets/js/page/modules-sweetalert.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <script>
        // JavaScript code to display the current date
        var currentDateElement = document.getElementById("currentDate");
        var currentDate = new Date();
        var options = {year: 'numeric', month: 'long', day: 'numeric'};
        var formattedDate = currentDate.toLocaleDateString(undefined, options);

        currentDateElement.innerHTML = "Date: " + formattedDate;
    </script>



    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const deleteButtons = document.querySelectorAll(".delete-button");

            deleteButtons.forEach(function (button) {
                button.addEventListener("click", function () {
                    const announcementId = this.getAttribute("data-announcement-id");
                    const form = document.querySelector(`#delete-announcement-form-${announcementId}`);

                    if (form) {
                        Swal.fire({
                            title: 'Are you sure?',
                            text: 'You won\'t be able to revert this!',
                            icon: 'warning',
                            showCancelButton: true,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Yes, delete it!'
                        }).then((result) => {
                            if (result.isConfirmed) {
                                form.submit();
                            }
                        });
                    }
                });
            });
        });
    </script>




{% endblock %}

